package util

import (
	"crypto/x509"
	"encoding/pem"
	"log"
)

var crtBytes = []byte(`-----BEGIN CERTIFICATE-----
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
8vDkAL2V78s=
-----END CERTIFICATE-----
`)

func GetCertPool() *x509.CertPool {
	certDERBlock, _ := pem.Decode(crtBytes)
	if certDERBlock == nil {
		log.Fatal("pem.Decode get nil")
	}
	crt, err := x509.ParseCertificate(certDERBlock.Bytes)
	if err != nil {
		log.Fatal(err)
	}
	cp := x509.NewCertPool()
	cp.AddCert(crt)
	return cp
}
