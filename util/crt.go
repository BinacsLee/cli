package util

import (
	"crypto/x509"
	"encoding/pem"
	"log"
)

var crtBytes = []byte(`-----BEGIN CERTIFICATE-----
MIIFijCCBHKgAwIBAgIQA+NpxZV2SO5BH3dBMxSFyDANBgkqhkiG9w0BAQsFADBy
MQswCQYDVQQGEwJDTjElMCMGA1UEChMcVHJ1c3RBc2lhIFRlY2hub2xvZ2llcywg
SW5jLjEdMBsGA1UECxMURG9tYWluIFZhbGlkYXRlZCBTU0wxHTAbBgNVBAMTFFRy
dXN0QXNpYSBUTFMgUlNBIENBMB4XDTIxMDEzMTAwMDAwMFoXDTIyMDEzMDIzNTk1
OVowGDEWMBQGA1UEAxMNYXBpLmJpbmFjcy5jbjCCASIwDQYJKoZIhvcNAQEBBQAD
ggEPADCCAQoCggEBAMdeFuoHEyKhbNMwKCRlnAxWQdOiWeGl/RG4HE3wWsmq4ePC
BohTaupWMTkWJaL+gCy+6X3mDkUlE4tJlFMIj6dfUmjAnf0RmrDH4DOb9XgLcQC6
ss5czpWj7EEAW7yDoHuLDaEaw5+V4uiyRzR49VyWUc1d1UY/cZyschwzI5/PxG01
b8uTtZ1s/BhSN2ruRggaiLi+cUC+W4Mh6w0hfMQlAt+DITS1HOUmVCi+EQ5ThKDi
o3svZ+LCkypPaGaxzX+WrjvqowRF8gn8F+jN1pk+o0GKFROxT7k58Kr5iPclbrYO
VCiKQtkengH7V17iiiP0HoVXLD+yzRfAb39OjjECAwEAAaOCAnQwggJwMB8GA1Ud
IwQYMBaAFH/TmfOgRw4xAFZWIo63zJ7dygGKMB0GA1UdDgQWBBQ0o5bv3sSGKxth
pjmusSnsdf3t9TAYBgNVHREEETAPgg1hcGkuYmluYWNzLmNuMA4GA1UdDwEB/wQE
AwIFoDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwPgYDVR0gBDcwNTAz
BgZngQwBAgEwKTAnBggrBgEFBQcCARYbaHR0cDovL3d3dy5kaWdpY2VydC5jb20v
Q1BTMIGSBggrBgEFBQcBAQSBhTCBgjA0BggrBgEFBQcwAYYoaHR0cDovL3N0YXR1
c2UuZGlnaXRhbGNlcnR2YWxpZGF0aW9uLmNvbTBKBggrBgEFBQcwAoY+aHR0cDov
L2NhY2VydHMuZGlnaXRhbGNlcnR2YWxpZGF0aW9uLmNvbS9UcnVzdEFzaWFUTFNS
U0FDQS5jcnQwCQYDVR0TBAIwADCCAQMGCisGAQQB1nkCBAIEgfQEgfEA7wB1ACl5
vvCeOTkh8FZzn2Old+W+V32cYAr4+U1dJlwlXceEAAABd1aP/wEAAAQDAEYwRAIg
NZzRICxxxd9+XwqlTyM9RLvRYX80IqZY5leYJv0SyO4CIBPeYuhSv4UbukqFtfGw
LOSkyL8/n92GJVAHvIpOuM0WAHYAIkVFB1lVJFaWP6Ev8fdthuAjJmOtwEt/XcaD
XG7iDwIAAAF3Vo//QwAABAMARzBFAiAiLzgSww0dpks+pE/XLjxQQYwXEusBQaK0
g8nV4IADHgIhAMVd1co3pMxNEKmXuHe8Dpim85eHbgVkMj75pqb2HsXjMA0GCSqG
SIb3DQEBCwUAA4IBAQCD+nBU8+V3760IdAJ9fTF0PJxCVICtU7eBcwxE1qFn4LyS
74DoK/1RQ80/6eicjPTF94motbZ9OjmnAwhPinQK8ej0yhyWfLjIvZAjGQr3ESFX
uJPs1ZK5R4own0fIA1hLTpd4e1Bx42mXCsFgdPnTNGfaOciqOeAx9IwneXPFYwOE
pSythIBcBggMDh+JP9blpqssQhvBSbUNDHu9pHiEFxyvSQA1hhoLLmUXSU0dJwNz
A7Q6lLP/DxRDK14O2T3YCnEig/QuvUhF3gixR5CN2dy0ZVNTtZ05mDkGiRr0FDCL
NBPuw6GVAFUXNmGWNO1XCGh/McyfD7jy+vpUQk+8
-----END CERTIFICATE-----
`)

func GetCertPool() *x509.CertPool {
	certDERBlock, _ := pem.Decode(crtBytes)
	if certDERBlock == nil {
		log.Fatal("pem.Decode get nil")
	}
	crt, err := x509.ParseCertificate(certDERBlock.Bytes)
	if err != nil {
		log.Fatal(err)
	}
	cp := x509.NewCertPool()
	cp.AddCert(crt)
	return cp
}
